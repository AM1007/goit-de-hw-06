# Homework for the Topic: "Spark Streaming"

### [Solution (Screenshots of program execution explained)](./Solution_explained.md)

In this assignment, you need to create a program that analyzes data from a Kafka topic generated by sensors and writes alerts to an alert Kafka topic based on certain conditions.

> [!TIP] > ðŸ‘“ Data that exceeds acceptable values is referred to as alerts. For example, when temperature or humidity goes beyond the permissible range.

### Step-by-Step Instructions

**1. Data Stream Generation:**

The input data is a Kafka topic stream, similar to the one used in the previous homework. Generate a data stream containing the fields: `id`, `temperature`, `humidity`, and `timestamp`. You can use the script and topic you created earlier.

**2. Data Aggregation:**

Read the data stream generated in the first step. Using a sliding window with a length of 1 minute, a _sliding interval_ of 30 seconds, and a _watermark duration_ of 10 seconds, calculate the average temperature and humidity.

**3. Understanding Alert Parameters:**

Your manager likes to frequently change alert criteria. To avoid redeploying code each time, the alert parameters are specified in a file:
alerts_conditions.csv

This file contains maximum and minimum values for temperature and humidity, an alert message, and an alert code. Values of -999, -999 indicate that those limits are not used for a particular alert.

Take a look at the file data. It should be intuitive to understand. You need to read the data from the file and use it to configure the alerts.

**4. Defining Alerts:**

Once you calculate the average values, determine whether they meet the criteria specified in the file (hint: perform a cross join and filter the data).

**5. Writing Data to a Kafka Topic:**

Write the generated alerts to an output Kafka topic.

Example of a Kafka message produced by this code:

```python
{
  "window":{
    "start": "2024-08-18T16:08:00.000+03:00",
    "end": "2024-08-18T16:09:00.000+03:00"
  },
  "t_avg": 56.615384615384461,
  "h_avg": 58.07692307692308,
  "code": "104",
  "message": "It's too hot",
  "timestamp": "2024-08-18 16:05:50.907777"
}
```
